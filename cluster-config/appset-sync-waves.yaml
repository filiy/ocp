  apiVersion: argoproj.io/v1alpha1
  kind: ApplicationSet
  metadata:
    name: cluster-config-test
    namespace: openshift-gitops
  spec:
    generators:
      - git:
          directories:
            - path: cluster-config-test/*
          repoURL: 'https://github.com/filiy/ocp'
          revision: HEAD
    goTemplate: true
    template:
      metadata:
        annotations:
          argocd.argoproj.io/sync-wave: '{{ (index (splitList "-" .path.basename) 0) | int }}'
        labels:
          appset: cluster-config
        name: 'cluster-config-{{.path.basename}}'
      spec:
        destination:
          namespace: default
          server: 'https://kubernetes.default.svc'
        project: default
        source:
          path: '{{.path.path}}'
          repoURL: 'https://github.com/filiy/ocp'
          targetRevision: HEAD
        syncPolicy:
          syncOptions:
            - CreateNamespace=true